############################################# Entrando com a Interface pessoal ############################################ 

#Entrando com os pacotes necessários para análise

#install.packages("shiny")
library(shiny)
#install.packages("shinydashboard")
library(shinydashboard)
#install.packages("survival")
library(survival)
#install.packages("ggplot2")
library(ggplot2)
#install.packages("survminer")
library(survminer)
#install.packages("curl")
library(curl)
#install.packages("car")
library(car)
#install.packages("agricolae")
library(agricolae)
#install.packages("DT")
library(DT)
#install.packages("knitr")
library(knitr)
#install.packages("readxl")
library(readxl)
#install.packages("viridis")
library(viridis)
#install.packages("hrbrthemes")
library(hrbrthemes)
#install.packages("tidyverse")
library(tidyverse)
#install.packages("plotly")
library(plotly)

#Criação da interface pessoal 

page <-  dashboardPage(skin = "green", 
                       # Foi modificado a formatação do texto no topo da página, adicionados links para sites externos e quadros de mensagens no topo da tela
                       
                       header <- dashboardHeader(title = span(
                         "5ª Vara da Justiça Federal", # Título do Dashboard
                         style = "font-family: Tahoma; font-weight: bold" 
                       ),titleWidth = "400px",
                       tags$li(a(href = 'http://google.com.br', # página externa
                                 icon("wifi"),
                                 title = "Página interna"),
                               class = "dropdown"),
                       tags$li(a(href = 'https://portal.trf1.jus.br/sjdf/', # página externa
                                 icon("link"),
                                 #img(src = 'https://pbs.twimg.com/profile_images/865670431830818816/1l4aMf6A_400x400.jpg', # opção de colocar uma foto no icone de acesso
                                 title = "Página da Justiça Federal", height = "30px"),
                               #style = "padding-top:10px; padding-bottom:10px;",
                               class = "dropdown"),
                       dropdownMenu(type = "message", #Criando uma mensagem de notificação
                                    messageItem(from = "Desenvolvedores", message = "Bem vindo a versão Beta do Dashboard"), # Mensagem de Boas vindas
                                    messageItem(from = "Desenvolvedores", message = "Em caso de erros informar ao desenvolvedor", icon = icon("r-project")) #Notificação de erro
                       )),
                       
                       sidebar <- dashboardSidebar( uiOutput("sidebarpanel")),
                       
                       body <- dashboardBody( uiOutput("body"),
                                              
                                              tabItems(
                                                tabItem(tabName = "dashboard", # Adicionando as caixas de InfoBox na aba DashBoard 
                                                        
                                                        fluidRow(
                                                          infoBox("Processos Encerrados",10,icon = icon("tags"),color = "aqua"), #Inserindo a tag com frequência
                                                          infoBox("Tempo médio de Sobrevivência", paste0("15 dias") ,icon = icon("calculator"),color = "orange"),
                                                          infoBox("Tempo de Sobrevivência", paste0("10 dias") ,icon = icon("thumbs-up", lib = "glyphicon"),color = "orange",fill = FALSE),
                                                          infoBox("Vida média Residual", paste0("5 dias") ,icon = icon("list"),color = "purple"),
                                                          infoBox("Taxa de Risco", paste0("40%") ,icon = icon("percent"),color = "green"),
                                                          infoBox("Função de Sobrevivência", paste0("60%") ,icon = icon("heart"),color = "red")),
                                                        
                                                        fluidRow(
                                                          box(plotOutput("histogram1")), #Gráfico 1
                                                          box(plotOutput("histogram2")), #Gráfico 2
                                                          box(plotOutput("histogram3")), #Gráfico 3
                                                          box(plotOutput("histogram4")) #Gráfico 4
                                                        )),
                                                
                                                tabItem(tabName = "Resumo", # Adicionando as caixas de InfoBox na aba Resumo 
                                                        
                                                        fluidRow(
                                                          infoBox("Numero Total de Processos",nrow(Status),icon = icon("archive"),color = "aqua"), #Inserindo a tag com frequência
                                                          infoBox("Número Total de Encerrados", nrow(Status[Status[,4] == "Encerrado",]) ,icon = icon("folder-minus"),color = "purple"),
                                                          infoBox("Número Total de Abertos", nrow(Status[Status[,4] == "Aberto",]) ,icon = icon("folder-open", lib = "glyphicon"),color = "orange",fill = FALSE),
                                                          infoBox("Número Total Status (Ok)", nrow(Status[Status[,5] == "Ok",]) ,icon = icon("thumbs-up"),color = "green"),
                                                          infoBox("Número Total Status (Alerta)", nrow(Status[Status[,5] == "Alerta",]) ,icon = icon("exclamation-triangle"),color = "yellow"),
                                                          infoBox("Número Total Status (Atrasado)", nrow(Status[Status[,5] == "Atrasado",]) ,icon = icon("thumbs-down"),color = "red")),
                                                        
                                                        fluidRow(
                                                          box(plotOutput("Resumo1")), #Gráfico 1
                                                          box(plotOutput("Resumo2")), #Gráfico 2
                                                          box(plotOutput("Resumo3")), #Gráfico 3
                                                          box(plotOutput("Resumo4")) #Gráfico 4
                                                        )),
                                                
                                                
                                                tabItem(tabName = "Classes", # Adicionando as caixas de texto na aba Análise Processual 
                                                        
                                                        fluidRow(
                                                          tabBox(
                                                            side = "right", height = "250px", width = '90%',
                                                            title = "Funcionamento dos processos",
                                                            # The id lets us use input$tabset1 on the server to find the current ta
                                                            tabPanel(" ",p("Os processos públicos administrados pela",em(strong("5ª Vara da Justiça Federal")),em("constituem cinquenta e cinco diferentes categorias de pleitos divididos em: Ações Civis Coletivas, Ações Populares, Buscas e Apreensões, Arrestos, Protestos e etc. Dessa maneira, a instituição possui como encargo a necessidade de triagem das fases processuais contabilizadas desde o recebimento até a conclusão do mesmo pleito, sendo tais etapas contabilizadas em trinta e oito estágios divididos em seis setores internos a instituição (Secretaria, Gabinete, Central de Mandados, Requerido, Requerente e Perito).", align = "center")),
                                                                     
                                                                     p("Cada uma das trinta e oito fases pré-definidas no quadro abaixo, possuem tempo limite de duração estruturado em artigos do Código de Processo Civil" ,em(strong("nº 297, 802, 896, 1.065, 1.106, 536 e 508")),em(". Necessitando-se assim da colaboração e compreensão dos advogados e servidores para realização das atividades dentro dos prazos delimitados, uma vez que nos termos das leis acima mencionadas, a principio não haverá nenhuma hipótese de prorrogação.", align = "left"))
                                                                     , height = "350px", width = '100%')
                                                          ),
                                                          
                                                          tabBox(
                                                            side = "right", height = "1320px", width = '90%',
                                                            title = "Tabela com o tempo limite dos processos segundo a lei",
                                                            # The id lets us use input$tabset1 on the server to find the current ta
                                                            tabPanel("","", height = "350px", width = '100%'),
                                                            fluidRow(
                                                              tableOutput("data1"))
                                                          )
                                                        ),
                                                        
                                                        fluidRow(
                                                          box(plotOutput("histogram5")), #Gráfico 1
                                                          box(plotOutput("histogram61")), #Gráfico 2
                                                          box(plotOutput("histogram6")), #Gráfico 3
                                                          box(plotOutput("histogram62"))) #Gráfico 4
                                                ),
                                                
                                                tabItem(tabName = "Manual", # Adicionando as caixas de texto na aba Manual de uso  
                                                        
                                                        fluidRow(
                                                          tabBox(
                                                            side = "right", height = "350px", width = '90%',
                                                            title = "Breve Descrição sobre o funcionamento do software",
                                                            # The id lets us use input$tabset1 on the server to find the current ta
                                                            tabPanel(" ","O processo referencia ... ", height = "350px", width = '100%')
                                                          ),
                                                          
                                                          tabBox(
                                                            side = "right", height = "350px", width = '90%',
                                                            title = "Explicação sobre os gráficos utilizados",
                                                            # The id lets us use input$tabset1 on the server to find the current ta
                                                            tabPanel(" ","O gráfico referente a Função de sobrevivência ...", height = "350px", width = '100%',
                                                                     tags$div(tags$ul(
                                                                       tags$li("Imagem 1 ..."),
                                                                       tags$li("Imagem 2 ..."),
                                                                       tags$li("Imagem 3 ...")),  style = "font-size: 15px"))
                                                          )
                                                        ),
                                                        
                                                        fluidRow(
                                                          box(plotOutput("histogramManual1")), #Gráfico 1
                                                          box(plotOutput("histogramManual2")), #Gráfico 2
                                                          box(plotOutput("histogramManual3")), #Gráfico 3
                                                          box(plotOutput("histogramManual4")), #Gráfico 4
                                                          box(plotOutput("histogramManual5")), #Gráfico 5
                                                          box(plotOutput("histogramManual12")),#Gráfico 12
                                                          box(plotOutput("histogramManual7")), #Gráfico 7
                                                          box(plotOutput("histogramManual8")), #Gráfico 8
                                                          box(plotOutput("histogramManual11")) #Gráfico 11
                                                          
                                                        )
                                                ),
                                                
                                                tabItem(tabName = "requisitos", # Adicionando as caixas de texto na aba Requisitos
                                                        
                                                        fluidRow(
                                                          tabBox(
                                                            side = "right", height = "350px", width = '90%',
                                                            title = "Breve explicação sobre os pré-requisitos da análise",
                                                            # The id lets us use input$tabset1 on the server to find the current ta
                                                            tabPanel(" ","Os pré-requisitos são ... ", height = "350px", width = '100%')
                                                          )),
                                                        
                                                        fluidRow(
                                                          box(plotOutput("histogram9")), #Gráfico 1
                                                          box(plotOutput("histogram10"))) #Gráfico 2
                                                ),
                                                
                                                # Eu ocultei a saída da visualização dos processos por tempo decorrido
                                                
                                                #tabItem(
                                                #  tabName = "visual",
                                                #  fluidRow(
                                                #    dataTableOutput("table1")
                                                #  )
                                                #),
                                                
                                                tabItem(
                                                  tabName = "visual2",
                                                  fluidRow(
                                                    dataTableOutput("tablevisual")
                                                  )
                                                ),
                                                
                                                tabItem(
                                                  tabName = "entrada",
                                                  fluidRow(
                                                    dataTableOutput("table2")
                                                  )
                                                ),
                                                tabItem(
                                                  tabName = "atualizacao",
                                                  fluidRow(
                                                    dataTableOutput("table3")
                                                  )
                                                ),
                                                
                                                tabItem(
                                                  tabName = "prazos",
                                                  fluidRow(
                                                    dataTableOutput("table4")
                                                  )
                                                ),
                                                
                                                tabItem(
                                                  tabName = "AtuaPra",
                                                  fluidRow(
                                                    dataTableOutput("table5")
                                                  )
                                                )
                                              )
                       )
)

ui <- dashboardPage(header,sidebar, body)